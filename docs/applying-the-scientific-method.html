<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Applying the Scientific Method | bookdown: Authoring Books and Technical Documents with R Markdown</title>
  <meta name="description" content="A workbook to accompany Quantitative Thinking in Range and Animal Sciences." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Applying the Scientific Method | bookdown: Authoring Books and Technical Documents with R Markdown" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://iraparsons.com/FundQuantitativeMethods/images/BookCover.jpg" />
  <meta property="og:description" content="A workbook to accompany Quantitative Thinking in Range and Animal Sciences." />
  <meta name="github-repo" content="FundQuantitativeMethods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Applying the Scientific Method | bookdown: Authoring Books and Technical Documents with R Markdown" />
  
  <meta name="twitter:description" content="A workbook to accompany Quantitative Thinking in Range and Animal Sciences." />
  <meta name="twitter:image" content="https://iraparsons.com/FundQuantitativeMethods/images/BookCover.jpg" />

<meta name="author" content="Yihui Xie" />


<meta name="date" content="2025-08-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="science.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Thinking</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The Nature of Knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="science.html"><a href="science.html"><i class="fa fa-check"></i><b>1</b> Science</a>
<ul>
<li class="chapter" data-level="1.1" data-path="science.html"><a href="science.html#how-you-know-what-you-know-and-is-what-you-know-really-so"><i class="fa fa-check"></i><b>1.1</b> How you know what you know, and is what you know really so?</a></li>
<li class="chapter" data-level="1.2" data-path="science.html"><a href="science.html#history-of-scientific-inquiry"><i class="fa fa-check"></i><b>1.2</b> History of scientific inquiry</a></li>
<li class="chapter" data-level="1.3" data-path="science.html"><a href="science.html#paradigms-of-statistical-inference"><i class="fa fa-check"></i><b>1.3</b> Paradigms of Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html"><i class="fa fa-check"></i><b>2</b> Applying the Scientific Method</a>
<ul>
<li class="chapter" data-level="2.1" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#program-r"><i class="fa fa-check"></i><b>2.1</b> Program R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#introduction-to-r"><i class="fa fa-check"></i><b>2.1.1</b> Introduction to R</a></li>
<li class="chapter" data-level="2.1.2" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#using-r"><i class="fa fa-check"></i><b>2.1.2</b> Using R</a></li>
<li class="chapter" data-level="2.1.3" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#why-not-use-r"><i class="fa fa-check"></i><b>2.1.3</b> Why not use R?</a></li>
<li class="chapter" data-level="2.1.4" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#navigating-r-studio"><i class="fa fa-check"></i><b>2.1.4</b> Navigating R Studio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#using-r-1"><i class="fa fa-check"></i><b>2.2</b> Using R</a></li>
<li class="chapter" data-level="2.3" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#exploratory-data-analysis-and-graphics"><i class="fa fa-check"></i><b>2.3</b> Exploratory Data Analysis and Graphics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#study-description"><i class="fa fa-check"></i><b>2.3.1</b> Study description</a></li>
<li class="chapter" data-level="2.3.2" data-path="applying-the-scientific-method.html"><a href="applying-the-scientific-method.html#graphs"><i class="fa fa-check"></i><b>2.3.2</b> Graphs</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">bookdown: Authoring Books and Technical Documents with R Markdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applying-the-scientific-method" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Applying the Scientific Method<a href="applying-the-scientific-method.html#applying-the-scientific-method" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="program-r" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Program R<a href="applying-the-scientific-method.html#program-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-to-r" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Introduction to R<a href="applying-the-scientific-method.html#introduction-to-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Program R is a robust statistical modeling software widely adopted and freely available. R is a full fledged computer language with sophisticated data structures. It is created by statisticians as an interactive environment for data analysis, allowing for both interacting with data in an exploratory maneer while maintaining the critical aspects of reproducibility. These scripts serve as a permanent record for analysis you have performed, allowing for quick re-execution at any moment or the incorporation of new data. If you are patient, you will find the unequaled attractiveness and power of R for both data analysis and visualization.</p>
<p>Attractive features of R include:</p>
<ol style="list-style-type: decimal">
<li>Free and open source</li>
<li>Runs on all major platforms, including Windows, MacOS, LINUX</li>
<li>Script sharing is easy across platforms</li>
<li>Large and active community of users, including plethura of new libraries implementing the latest methods</li>
<li>Easy to publish and distribute new methods.</li>
</ol>
</div>
<div id="using-r" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Using R<a href="applying-the-scientific-method.html#using-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To use R, follow the following steps.</p>
<ol style="list-style-type: decimal">
<li>Go to Program R’s website (<a href="https://www.r-project.org" class="uri">https://www.r-project.org</a>)</li>
<li>Select the Download R link, select your prefered CRAN mirror (I typically pick Iowa State, here is a link directly to that mirror <a href="https://mirror.las.iastate.edu/CRAN/" class="uri">https://mirror.las.iastate.edu/CRAN/</a>)</li>
<li>Select the version for your machine (Windows, Mac etc.)</li>
<li>Open the install engine and follow the steps.</li>
</ol>
<p>Opening R should show you the R console, which looks something like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="applying-the-scientific-method.html#cb1-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/rconsole.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="images/rconsole.png" alt="R console" width="272" />
<p class="caption">
Figure 2.1: R console
</p>
</div>
<p>This is powerful, but likely not as approachable as you would like. To address this, I strongly recommend using an IDE (Integrated Development Environment) which serves to put all of the best features of a programming languange at the forefront. For R, there are many, includinge <a href="https://code.visualstudio.com">VSCode</a>, <a href="https://jupyter.org">Jupyter Notebooks</a>, and <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>.</p>
<p>I recommend <a href="https://posit.co/download/rstudio-desktop/">RStudio</a>, and will be using it throughout the course.
1. Go to the link for RStudio (<a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a>) and download the appropriate Rstudio for your computer.
2. Run the install engine, which should go find your installation of R.</p>
<p><strong>!! You must install R first, then RStudio !!</strong></p>
</div>
<div id="why-not-use-r" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Why not use R?<a href="applying-the-scientific-method.html#why-not-use-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using R is strongly recommended in this class. It is a powerful tool that can manage some of the most taxing of statistical methods, is free, and many times more capable than software that costs many thousands of dollars per user license. It is used extensively by both academia and industry, including tech giants like Amazon and Google. While it is possible to do any of these things in programs like SAS, JMP, SPSS, or even Excel, they are not free, they can be clunky to use, and you will have to figure it out on your own as I haven’t used those softwares in many years. Thus, I would very much encourage you to give R a shot.</p>
</div>
<div id="navigating-r-studio" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Navigating R Studio<a href="applying-the-scientific-method.html#navigating-r-studio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Upon opening R studio, you should see an interface that looks something like this.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="applying-the-scientific-method.html#cb2-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/rstudio.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="images/rstudio.png" alt="RStudio" width="1056" />
<p class="caption">
Figure 2.2: RStudio
</p>
</div>
<p>The left paine shows the R console. The top right pane includes tabs showing the objects, datasets, functions and values loaded in the R environment. Other tabs include showing the history of executed code during the current session, connections to servers, GIT, and other tabs loaded as needed depending on what addons you have. The bottom right pain includes tabs showing files in the current folder for the current R project, plots built from executed code, packages and ability to install other packages, Veiwer for markdown files (such as this one), and presentations. When you start or open an R script, it will add a 4th pane in the the top left where .R and .rmd files can be edited. Note that this is the default arrangement, and your appearance is customization as you see fit.</p>
</div>
</div>
<div id="using-r-1" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Using R<a href="applying-the-scientific-method.html#using-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exploratory-data-analysis-and-graphics" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Exploratory Data Analysis and Graphics<a href="applying-the-scientific-method.html#exploratory-data-analysis-and-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When approaching a data set, it is important to do due diligence and ensure that a complete understanding of the data is achieved before further analysis or publication is undertaken. This can be achieved in a number of ways, which will be enumerated below. As with any analysis, an understanding of the studies experimental design is critical to understanding what values may be expected within the data sheet, and will lend insight into what potential analysis may be conducted.</p>
<p>When opening a data set, it is important to have an understanding of what to expect. This includes such things as the study design and description, and the meta-data associated with the data sheets. Meta data, at the very least, should include descriptions of the column names, and indicate the type of data you might expect to be within. It may also include information concerning individual observations, such as animals that died or were pulled from the study, why they might have been pulled, and other factors that should be considered when analyzing the data.</p>
<p>File and column names should be kept as simple, yet descriptive, as possible. Use well known naming conventions, and avoid the use of spaces, instead using underscores or dots. You will quickly understand the value of having well concieved naming conventions for things you will type a lot, such as the names of columns and data frames. As we go through the class, you will likely notice some of the naming conventions that I have adopted. Feel free to use and adopt these for you own use. You will undoubtedly find a specific style which better suits your specific fancy and needs, but I think it is important that you do adopt a style for your own sanity.</p>
<div id="study-description" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Study description<a href="applying-the-scientific-method.html#study-description" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Experimental Animals and Design: Seventy-two crossbred beef heifers (25% Bos indicus) born and raised at the McGregor AgriLife Research Center will be weaned in October at a range in age of 194-232 d. Forty-two days prior to weaning, calves will be weighed, exit velocity and chute scores (subjective temperament) recorded, and randomly allotted to 1 of 2 treatments (Control or Yeast) provided in a creep ration containing 18% CP (as-fed basis).</p>
<p>Upon weaning, blood samples will be collected for analyses of IgG titers, cortisol and haptaglobian concentrations, and body weight, exit velocity and chute score data collected. At this time, 32 heifers (16 Control, 16 Yeast) will have rumen temperature boluses inserted and HOBO accelerometer devices placed on the left hind leg to record activity data. Heifers will then be placed into a holding pen with hay and water. The following day, all heifers will be loaded on to a truck and shipped approximately 800 kilometers, before being returned to the Research Center. As heifers come off the truck, blood samples will be collected to determine cortisol and haptaglobin concentrations. The heifers will be placed in holding pens for the night. The following morning, heifer calves will be weighed, vaccinated for IBR, PI3, BVD, BRSV (product?) and Mannheimia (Niplura), and chute score and exit velocity measured.</p>
<p>Within creep treatment, heifers will be randomly assigned to 1 of 2 post-weaning treatments in a 2 x 2 factorial arrangement: (1) Pre-weaning Yeast and post-weaning Yeast, (2) Pre-weaning Yeast and post-weaning control, (3) Pre-weaning control and post-weaning control, and (4) Pre-weaning control and post-weaning Yeast. Heifers will be weighed at 7-d intervals and re-vaccinated on d 21 (IBR, PI3, BVD, BRSV, and Nuplora). Heifers in the 2 pens on the post-weaning Yeast treatments will be rotated every 7-d to minimize the potential pen effect. Likewise, heifers in the 2 pens on the post-weaning control treatments will be rotated weekly. Blood samples will be collected at the start of the study, and at weekly intervals to measure IgG titer responses to IBR and Mannheimia vaccinations. Individual-animal intakes and feeding behavior (e.g., bunk visit and meal frequency and duration) data will be collected daily by the GrowSafe System. Time to bunk following feed truck delivery will also be measured daily using the GrowSafe System. Throughout the trial, the system will be monitored twice daily to ensure accuracy of the feed intake data. To ensure data quality of the feed intake and feeding behavior data, the average assigned feed disappearance (AFD) rate will be computed daily, and data for all animals in a pen deleted if AFD for a given day is less than 95%. Exit velocity and chute scores (objective and subjective temperature traits) will be measured at prior to creep feeding, weaning, prior to sorting, and the end of the trial. The HOBO devices will measure physical activity. Serum cortisol and haptaglobin concentrations will be measured before and after shipping and 28-d and 56-d after the beginning of the study. Treatment premixes, and treatment total mixed ration samples will be collected weekly and stored at 20 C (refrigerator). Immediately following the completion of the study, the weekly samples will be composited by weight, and samples sent for yeast analysis. The TMR composite samples will be analyzed to obtain a complete nutritional profile. The treatment TMRs will be fed once daily, and feed bunks will be cleaned once weakly with ort samples collected and stored at 20 C as deemed necessary.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="applying-the-scientific-method.html#cb3-1" tabindex="-1"></a><span class="co"># 2 Exploratory Analysis and Graphics</span></span>
<span id="cb3-2"><a href="applying-the-scientific-method.html#cb3-2" tabindex="-1"></a><span class="co"># Libraries ----</span></span>
<span id="cb3-3"><a href="applying-the-scientific-method.html#cb3-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Graphing </span></span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.2     ✔ tibble    3.2.1
## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
## ✔ purrr     1.0.4     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="applying-the-scientific-method.html#cb5-1" tabindex="-1"></a><span class="fu">library</span>(data.table) <span class="co"># Reading data and manipulating data</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;data.table&#39;
## 
## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week,
##     yday, year
## 
## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     between, first, last
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     transpose</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="applying-the-scientific-method.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># Reading excel</span></span>
<span id="cb7-2"><a href="applying-the-scientific-method.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="applying-the-scientific-method.html#cb7-3" tabindex="-1"></a><span class="co"># Data -----</span></span>
<span id="cb7-4"><a href="applying-the-scientific-method.html#cb7-4" tabindex="-1"></a><span class="fu">excel_sheets</span>(<span class="at">path =</span> <span class="st">&#39;../../Documents/AS791_FundQuantThink/Data/LAN/LAN_1504_DATA.xlsx&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Notes&quot;                &quot;LAN_1504&quot;             &quot;Graphs&quot;              
##  [4] &quot;Sheet1&quot;               &quot;Charts&quot;               &quot;date_relative&quot;       
##  [7] &quot;RawWeight(lbs)&quot;       &quot;Day28_IntakeSAS&quot;      &quot;ADJ_28Day_Intake&quot;    
## [10] &quot;ADJ_28Day_BW&quot;         &quot;Day28_RFI&quot;            &quot;Day56_IntakeSAS&quot;     
## [13] &quot;ADJ_56Day_Intake&quot;     &quot;ADJ_56Day_BW&quot;         &quot;Day56_RFI&quot;           
## [16] &quot;Day70_Intake_SAS&quot;     &quot;ADJ_70Day_Intake&quot;     &quot;ADJ_Day70_BW&quot;        
## [19] &quot;Day70_RFI&quot;            &quot;TTBxAnimalxDay&quot;       &quot;TTB&quot;                 
## [22] &quot;AveragexDay&quot;          &quot;Final Data&quot;           &quot;Day14_outputallday&quot;  
## [25] &quot;Day14_outputallhour&quot;  &quot;Day42_outputallday&quot;   &quot;Day42_outputallhour&quot; 
## [28] &quot;outputallday_cmbnd&quot;   &quot;outputallhour_combnd&quot; &quot;D-1&quot;                 
## [31] &quot;D0&quot;                   &quot;D28&quot;                  &quot;D56&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="applying-the-scientific-method.html#cb9-1" tabindex="-1"></a>d.bw <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&#39;../../Documents/AS791_FundQuantThink/Data/LAN/LAN_1504_DATA.xlsx&#39;</span>,</span>
<span id="cb9-2"><a href="applying-the-scientific-method.html#cb9-2" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">&quot;RawWeight(lbs)&quot;</span>)</span>
<span id="cb9-3"><a href="applying-the-scientific-method.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="applying-the-scientific-method.html#cb9-4" tabindex="-1"></a><span class="co"># Summary Statistics -----</span></span>
<span id="cb9-5"><a href="applying-the-scientific-method.html#cb9-5" tabindex="-1"></a><span class="fu">str</span>(d.bw)</span></code></pre></div>
<pre><code>## tibble [78 × 21] (S3: tbl_df/tbl/data.frame)
##  $ Ref ID       : num [1:78] 1 2 3 4 5 6 7 8 9 10 ...
##  $ VID          : num [1:78] 248 249 276 298 322 346 364 367 453 472 ...
##  $ EID          : num [1:78] 9.82e+14 9.82e+14 9.82e+14 9.82e+14 9.82e+14 ...
##  $ Creep        : chr [1:78] &quot;Control&quot; &quot;Control&quot; &quot;Yeast&quot; &quot;Yeast&quot; ...
##  $ Trial        : chr [1:78] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Pen          : num [1:78] 8 8 6 6 8 6 5 7 6 5 ...
##  $ BW-42        : num [1:78] 574 463 389 436 436 416 420 352 429 402 ...
##  $ BW-1         : num [1:78] 650 514 453 504 512 446 510 390 508 485 ...
##  $ BW0          : num [1:78] 638 504 445 489 504 441 479 372 481 474 ...
##  $ BW7          : num [1:78] 636 496 450 487 532 398 481 377 492 469 ...
##  $ BW14         : num [1:78] 670 512 477 522 562 418 516 388 508 486 ...
##  $ BW21         : num [1:78] 716 544 508 530 592 443 548 411 544 522 ...
##  $ BW28         : num [1:78] 698 544 499 530 592 447 552 416 544 520 ...
##  $ BW35         : num [1:78] 732 564 534 566 600 464 584 463 558 552 ...
##  $ BW42         : num [1:78] 732 576 550 590 628 480 590 466 586 556 ...
##  $ BW49         : num [1:78] 768 600 548 578 654 468 600 478 578 560 ...
##  $ BW56         : num [1:78] 786 608 594 624 678 518 628 496 616 584 ...
##  $ BW70         : num [1:78] 806 670 636 650 702 560 676 518 650 628 ...
##  $ Shipping Loss: num [1:78] -12 -10 -8 -15 -8 -5 -31 -18 -27 -11 ...
##  $ Creep_Gain   : num [1:78] 76 51 64 68 76 30 90 38 79 83 ...
##  $ Pre-Wean_ADG : num [1:78] 1.81 1.21 1.52 1.62 1.81 ...</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="applying-the-scientific-method.html#cb11-1" tabindex="-1"></a><span class="fu">nrow</span>(d.bw)</span></code></pre></div>
<pre><code>## [1] 78</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="applying-the-scientific-method.html#cb13-1" tabindex="-1"></a><span class="fu">unique</span>(d.bw<span class="sc">$</span>VID)</span></code></pre></div>
<pre><code>##  [1] 248 249 276 298 322 346 364 367 453 472 510 538 571 661 662 663 664 667 668
## [20] 672 674 677 678 679 682 684 688 690 691 692 693 701 702 703 704 706 707 711
## [39] 712 714 717 718 719 721 722 723 724 726 727 729 731 734 735 743 744 747 749
## [58] 752 756 760 762 764 765 766 768 769 771 772 775 780 783 785 799 805 808 813
## [77] 815 821</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="applying-the-scientific-method.html#cb15-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(d.bw<span class="sc">$</span>VID))</span></code></pre></div>
<pre><code>## [1] 78</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="applying-the-scientific-method.html#cb17-1" tabindex="-1"></a><span class="do">## Data Wrangling -----</span></span>
<span id="cb17-2"><a href="applying-the-scientific-method.html#cb17-2" tabindex="-1"></a><span class="fu">names</span>(d.bw)</span></code></pre></div>
<pre><code>##  [1] &quot;Ref ID&quot;        &quot;VID&quot;           &quot;EID&quot;           &quot;Creep&quot;        
##  [5] &quot;Trial&quot;         &quot;Pen&quot;           &quot;BW-42&quot;         &quot;BW-1&quot;         
##  [9] &quot;BW0&quot;           &quot;BW7&quot;           &quot;BW14&quot;          &quot;BW21&quot;         
## [13] &quot;BW28&quot;          &quot;BW35&quot;          &quot;BW42&quot;          &quot;BW49&quot;         
## [17] &quot;BW56&quot;          &quot;BW70&quot;          &quot;Shipping Loss&quot; &quot;Creep_Gain&quot;   
## [21] &quot;Pre-Wean_ADG&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="applying-the-scientific-method.html#cb19-1" tabindex="-1"></a>d.bw2 <span class="ot">=</span> <span class="fu">pivot_longer</span>(<span class="at">data =</span> d.bw, <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">18</span>))</span>
<span id="cb19-2"><a href="applying-the-scientific-method.html#cb19-2" tabindex="-1"></a>(<span class="dv">18-6</span>) <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">unique</span>(d.bw<span class="sc">$</span>VID))</span></code></pre></div>
<pre><code>## [1] 936</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="applying-the-scientific-method.html#cb21-1" tabindex="-1"></a>(<span class="dv">18-6</span>) <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">unique</span>(d.bw<span class="sc">$</span>VID)) <span class="sc">==</span> <span class="fu">nrow</span>(d.bw2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="applying-the-scientific-method.html#cb23-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(d.bw2<span class="sc">$</span>VID))</span></code></pre></div>
<pre><code>## [1] 78</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="applying-the-scientific-method.html#cb25-1" tabindex="-1"></a><span class="fu">str</span>(d.bw2)</span></code></pre></div>
<pre><code>## tibble [936 × 11] (S3: tbl_df/tbl/data.frame)
##  $ Ref ID       : num [1:936] 1 1 1 1 1 1 1 1 1 1 ...
##  $ VID          : num [1:936] 248 248 248 248 248 248 248 248 248 248 ...
##  $ EID          : num [1:936] 9.82e+14 9.82e+14 9.82e+14 9.82e+14 9.82e+14 ...
##  $ Creep        : chr [1:936] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Trial        : chr [1:936] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Pen          : num [1:936] 8 8 8 8 8 8 8 8 8 8 ...
##  $ Shipping Loss: num [1:936] -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 ...
##  $ Creep_Gain   : num [1:936] 76 76 76 76 76 76 76 76 76 76 ...
##  $ Pre-Wean_ADG : num [1:936] 1.81 1.81 1.81 1.81 1.81 ...
##  $ name         : chr [1:936] &quot;BW-42&quot; &quot;BW-1&quot; &quot;BW0&quot; &quot;BW7&quot; ...
##  $ value        : num [1:936] 574 650 638 636 670 716 698 732 732 768 ...</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="applying-the-scientific-method.html#cb27-1" tabindex="-1"></a>d.bw2<span class="sc">$</span>Day <span class="ot">=</span> <span class="fu">extract_numeric</span>(d.bw2<span class="sc">$</span>name)</span></code></pre></div>
<pre><code>## extract_numeric() is deprecated: please use readr::parse_number() instead</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="applying-the-scientific-method.html#cb29-1" tabindex="-1"></a><span class="fu">str</span>(d.bw2)</span></code></pre></div>
<pre><code>## tibble [936 × 12] (S3: tbl_df/tbl/data.frame)
##  $ Ref ID       : num [1:936] 1 1 1 1 1 1 1 1 1 1 ...
##  $ VID          : num [1:936] 248 248 248 248 248 248 248 248 248 248 ...
##  $ EID          : num [1:936] 9.82e+14 9.82e+14 9.82e+14 9.82e+14 9.82e+14 ...
##  $ Creep        : chr [1:936] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Trial        : chr [1:936] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Pen          : num [1:936] 8 8 8 8 8 8 8 8 8 8 ...
##  $ Shipping Loss: num [1:936] -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 ...
##  $ Creep_Gain   : num [1:936] 76 76 76 76 76 76 76 76 76 76 ...
##  $ Pre-Wean_ADG : num [1:936] 1.81 1.81 1.81 1.81 1.81 ...
##  $ name         : chr [1:936] &quot;BW-42&quot; &quot;BW-1&quot; &quot;BW0&quot; &quot;BW7&quot; ...
##  $ value        : num [1:936] 574 650 638 636 670 716 698 732 732 768 ...
##  $ Day          : num [1:936] -42 -1 0 7 14 21 28 35 42 49 ...</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="applying-the-scientific-method.html#cb31-1" tabindex="-1"></a><span class="do">## Summary statistics</span></span>
<span id="cb31-2"><a href="applying-the-scientific-method.html#cb31-2" tabindex="-1"></a><span class="fu">summary</span>(d.bw)</span></code></pre></div>
<pre><code>##      Ref ID           VID             EID              Creep          
##  Min.   : 1.00   Min.   :248.0   Min.   :9.82e+14   Length:78         
##  1st Qu.:20.25   1st Qu.:672.5   1st Qu.:9.82e+14   Class :character  
##  Median :39.50   Median :713.0   Median :9.82e+14   Mode  :character  
##  Mean   :39.50   Mean   :671.2   Mean   :9.82e+14                     
##  3rd Qu.:58.75   3rd Qu.:755.0   3rd Qu.:9.82e+14                     
##  Max.   :78.00   Max.   :821.0   Max.   :9.82e+14                     
##     Trial                Pen          BW-42            BW-1      
##  Length:78          Min.   :5.0   Min.   :352.0   Min.   :380.0  
##  Class :character   1st Qu.:6.0   1st Qu.:395.5   1st Qu.:465.0  
##  Mode  :character   Median :6.5   Median :428.5   Median :501.0  
##                     Mean   :6.5   Mean   :429.3   Mean   :495.6  
##                     3rd Qu.:7.0   3rd Qu.:455.8   3rd Qu.:521.5  
##                     Max.   :8.0   Max.   :574.0   Max.   :650.0  
##       BW0             BW7             BW14            BW21      
##  Min.   :364.0   Min.   :334.0   Min.   :345.0   Min.   :370.0  
##  1st Qu.:449.0   1st Qu.:439.0   1st Qu.:440.2   1st Qu.:470.2  
##  Median :476.0   Median :466.5   Median :476.5   Median :507.0  
##  Mean   :475.3   Mean   :464.9   Mean   :478.9   Mean   :507.6  
##  3rd Qu.:502.0   3rd Qu.:491.8   3rd Qu.:511.5   3rd Qu.:543.5  
##  Max.   :638.0   Max.   :636.0   Max.   :670.0   Max.   :716.0  
##       BW28            BW35            BW42            BW49      
##  Min.   :364.0   Min.   :380.0   Min.   :383.0   Min.   :400.0  
##  1st Qu.:473.5   1st Qu.:490.2   1st Qu.:500.8   1st Qu.:521.5  
##  Median :507.0   Median :534.0   Median :547.0   Median :559.0  
##  Mean   :507.2   Mean   :532.4   Mean   :542.5   Mean   :557.3  
##  3rd Qu.:544.0   3rd Qu.:567.5   3rd Qu.:579.5   3rd Qu.:596.0  
##  Max.   :698.0   Max.   :732.0   Max.   :732.0   Max.   :768.0  
##       BW56            BW70       Shipping Loss       Creep_Gain    
##  Min.   :398.0   Min.   :412.0   Min.   :-116.00   Min.   : 13.00  
##  1st Qu.:538.5   1st Qu.:572.5   1st Qu.: -26.75   1st Qu.: 51.00  
##  Median :585.0   Median :622.0   Median : -18.00   Median : 68.00  
##  Mean   :579.4   Mean   :614.2   Mean   : -20.28   Mean   : 66.27  
##  3rd Qu.:619.5   3rd Qu.:655.0   3rd Qu.: -12.00   3rd Qu.: 79.75  
##  Max.   :786.0   Max.   :806.0   Max.   :   2.00   Max.   :186.00  
##   Pre-Wean_ADG   
##  Min.   :0.3095  
##  1st Qu.:1.2143  
##  Median :1.6190  
##  Mean   :1.5778  
##  3rd Qu.:1.8988  
##  Max.   :4.4286</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="applying-the-scientific-method.html#cb33-1" tabindex="-1"></a><span class="fu">summary</span>(d.bw2)</span></code></pre></div>
<pre><code>##      Ref ID          VID             EID              Creep          
##  Min.   : 1.0   Min.   :248.0   Min.   :9.82e+14   Length:936        
##  1st Qu.:20.0   1st Qu.:672.0   1st Qu.:9.82e+14   Class :character  
##  Median :39.5   Median :713.0   Median :9.82e+14   Mode  :character  
##  Mean   :39.5   Mean   :671.2   Mean   :9.82e+14                     
##  3rd Qu.:59.0   3rd Qu.:756.0   3rd Qu.:9.82e+14                     
##  Max.   :78.0   Max.   :821.0   Max.   :9.82e+14                     
##     Trial                Pen      Shipping Loss       Creep_Gain    
##  Length:936         Min.   :5.0   Min.   :-116.00   Min.   : 13.00  
##  Class :character   1st Qu.:6.0   1st Qu.: -27.00   1st Qu.: 51.00  
##  Mode  :character   Median :6.5   Median : -18.00   Median : 68.00  
##                     Mean   :6.5   Mean   : -20.28   Mean   : 66.27  
##                     3rd Qu.:7.0   3rd Qu.: -12.00   3rd Qu.: 80.00  
##                     Max.   :8.0   Max.   :   2.00   Max.   :186.00  
##   Pre-Wean_ADG        name               value            Day        
##  Min.   :0.3095   Length:936         Min.   :334.0   Min.   :-42.00  
##  1st Qu.:1.2143   Class :character   1st Qu.:461.0   1st Qu.:  5.25  
##  Median :1.6190   Mode  :character   Median :510.0   Median : 24.50  
##  Mean   :1.5778                      Mean   :515.4   Mean   : 23.25  
##  3rd Qu.:1.9048                      3rd Qu.:562.0   3rd Qu.: 43.75  
##  Max.   :4.4286                      Max.   :806.0   Max.   : 70.00</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="applying-the-scientific-method.html#cb35-1" tabindex="-1"></a>d.bw2 <span class="sc">%&gt;%</span> <span class="co"># Calculating summary statistics from long data by day</span></span>
<span id="cb35-2"><a href="applying-the-scientific-method.html#cb35-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Day) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="applying-the-scientific-method.html#cb35-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb35-4"><a href="applying-the-scientific-method.html#cb35-4" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(value),</span>
<span id="cb35-5"><a href="applying-the-scientific-method.html#cb35-5" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(value),</span>
<span id="cb35-6"><a href="applying-the-scientific-method.html#cb35-6" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(value))</span></code></pre></div>
<pre><code>## # A tibble: 12 × 5
##      Day  mean    SD   min   max
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   -42  429.  41.3   352   574
##  2    -1  496.  47.2   380   650
##  3     0  475.  44.6   364   638
##  4     7  465.  49.5   334   636
##  5    14  479.  54.8   345   670
##  6    21  508.  57.8   370   716
##  7    28  507.  58.4   364   698
##  8    35  532.  59.1   380   732
##  9    42  542.  61.4   383   732
## 10    49  557.  64.1   400   768
## 11    56  579.  64.8   398   786
## 12    70  614.  68.6   412   806</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="applying-the-scientific-method.html#cb37-1" tabindex="-1"></a>d.bw2 <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="applying-the-scientific-method.html#cb37-2" tabindex="-1"></a>  <span class="fu">group_by</span>(VID) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="applying-the-scientific-method.html#cb37-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb37-4"><a href="applying-the-scientific-method.html#cb37-4" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(value),</span>
<span id="cb37-5"><a href="applying-the-scientific-method.html#cb37-5" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(value),</span>
<span id="cb37-6"><a href="applying-the-scientific-method.html#cb37-6" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(value))</span></code></pre></div>
<pre><code>## # A tibble: 78 × 5
##      VID  mean    SD   min   max
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   248  700.  69.3   574   806
##  2   249  550.  57.6   463   670
##  3   276  507.  69.7   389   636
##  4   298  542.  61.6   436   650
##  5   322  583.  77.8   436   702
##  6   346  458.  45.1   398   560
##  7   364  549.  71.8   420   676
##  8   367  427.  54.7   352   518
##  9   453  541.  61.7   429   650
## 10   472  520.  60.8   402   628
## # ℹ 68 more rows</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="applying-the-scientific-method.html#cb39-1" tabindex="-1"></a><span class="co"># Check for NA&#39;s </span></span>
<span id="cb39-2"><a href="applying-the-scientific-method.html#cb39-2" tabindex="-1"></a>days <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(d.bw2<span class="sc">$</span>Day), <span class="fu">max</span>(d.bw2<span class="sc">$</span>Day), <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb39-3"><a href="applying-the-scientific-method.html#cb39-3" tabindex="-1"></a>Days <span class="ot">=</span> <span class="fu">data.table</span>(<span class="at">Day =</span> days)</span>
<span id="cb39-4"><a href="applying-the-scientific-method.html#cb39-4" tabindex="-1"></a>d.bw2 <span class="ot">=</span> <span class="fu">as.data.table</span>(d.bw2)</span>
<span id="cb39-5"><a href="applying-the-scientific-method.html#cb39-5" tabindex="-1"></a>VIDs <span class="ot">=</span> <span class="fu">data.table</span>(<span class="at">VID =</span> <span class="fu">unique</span>(d.bw2<span class="sc">$</span>VID))</span>
<span id="cb39-6"><a href="applying-the-scientific-method.html#cb39-6" tabindex="-1"></a><span class="dv">78</span><span class="sc">*</span><span class="dv">113</span></span></code></pre></div>
<pre><code>## [1] 8814</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="applying-the-scientific-method.html#cb41-1" tabindex="-1"></a>d.bw3 <span class="ot">=</span> <span class="fu">merge.data.table</span>(d.bw2,Days, <span class="at">all =</span> T)</span>
<span id="cb41-2"><a href="applying-the-scientific-method.html#cb41-2" tabindex="-1"></a><span class="fu">unique</span>(d.bw3<span class="sc">$</span>Day)</span></code></pre></div>
<pre><code>##   [1] -42 -41 -40 -39 -38 -37 -36 -35 -34 -33 -32 -31 -30 -29 -28 -27 -26 -25
##  [19] -24 -23 -22 -21 -20 -19 -18 -17 -16 -15 -14 -13 -12 -11 -10  -9  -8  -7
##  [37]  -6  -5  -4  -3  -2  -1   0   1   2   3   4   5   6   7   8   9  10  11
##  [55]  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29
##  [73]  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
##  [91]  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65
## [109]  66  67  68  69  70</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="applying-the-scientific-method.html#cb43-1" tabindex="-1"></a><span class="fu">summary</span>(d.bw3)</span></code></pre></div>
<pre><code>##       Day             Ref ID          VID             EID          
##  Min.   :-42.00   Min.   : 1.0   Min.   :248.0   Min.   :9.82e+14  
##  1st Qu.:  0.00   1st Qu.:20.0   1st Qu.:672.0   1st Qu.:9.82e+14  
##  Median : 21.00   Median :39.5   Median :713.0   Median :9.82e+14  
##  Mean   : 22.24   Mean   :39.5   Mean   :671.2   Mean   :9.82e+14  
##  3rd Qu.: 42.00   3rd Qu.:59.0   3rd Qu.:756.0   3rd Qu.:9.82e+14  
##  Max.   : 70.00   Max.   :78.0   Max.   :821.0   Max.   :9.82e+14  
##                   NA&#39;s   :101    NA&#39;s   :101     NA&#39;s   :101       
##     Creep              Trial                Pen      Shipping Loss    
##  Length:1037        Length:1037        Min.   :5.0   Min.   :-116.00  
##  Class :character   Class :character   1st Qu.:6.0   1st Qu.: -27.00  
##  Mode  :character   Mode  :character   Median :6.5   Median : -18.00  
##                                        Mean   :6.5   Mean   : -20.28  
##                                        3rd Qu.:7.0   3rd Qu.: -12.00  
##                                        Max.   :8.0   Max.   :   2.00  
##                                        NA&#39;s   :101   NA&#39;s   :101      
##    Creep_Gain      Pre-Wean_ADG        name               value      
##  Min.   : 13.00   Min.   :0.3095   Length:1037        Min.   :334.0  
##  1st Qu.: 51.00   1st Qu.:1.2143   Class :character   1st Qu.:461.0  
##  Median : 68.00   Median :1.6190   Mode  :character   Median :510.0  
##  Mean   : 66.27   Mean   :1.5778                      Mean   :515.4  
##  3rd Qu.: 80.00   3rd Qu.:1.9048                      3rd Qu.:562.0  
##  Max.   :186.00   Max.   :4.4286                      Max.   :806.0  
##  NA&#39;s   :101      NA&#39;s   :101                         NA&#39;s   :101</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="applying-the-scientific-method.html#cb45-1" tabindex="-1"></a><span class="co"># Calculate ADG ----</span></span>
<span id="cb45-2"><a href="applying-the-scientific-method.html#cb45-2" tabindex="-1"></a>d.bw2<span class="sc">$</span>VID <span class="ot">=</span> <span class="fu">as.character</span>(d.bw2<span class="sc">$</span>VID)</span>
<span id="cb45-3"><a href="applying-the-scientific-method.html#cb45-3" tabindex="-1"></a><span class="fu">str</span>(d.bw2)</span></code></pre></div>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   936 obs. of  12 variables:
##  $ Ref ID       : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ VID          : chr  &quot;248&quot; &quot;248&quot; &quot;248&quot; &quot;248&quot; ...
##  $ EID          : num  9.82e+14 9.82e+14 9.82e+14 9.82e+14 9.82e+14 ...
##  $ Creep        : chr  &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Trial        : chr  &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ Pen          : num  8 8 8 8 8 8 8 8 8 8 ...
##  $ Shipping Loss: num  -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 ...
##  $ Creep_Gain   : num  76 76 76 76 76 76 76 76 76 76 ...
##  $ Pre-Wean_ADG : num  1.81 1.81 1.81 1.81 1.81 ...
##  $ name         : chr  &quot;BW-42&quot; &quot;BW-1&quot; &quot;BW0&quot; &quot;BW7&quot; ...
##  $ value        : num  574 650 638 636 670 716 698 732 732 768 ...
##  $ Day          : num  -42 -1 0 7 14 21 28 35 42 49 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="applying-the-scientific-method.html#cb47-1" tabindex="-1"></a>m.adg <span class="ot">=</span> <span class="fu">lm</span>(value <span class="sc">~</span> Day, <span class="at">data =</span> d.bw2)</span>
<span id="cb47-2"><a href="applying-the-scientific-method.html#cb47-2" tabindex="-1"></a><span class="fu">summary</span>(m.adg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = value ~ Day, data = d.bw2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -179.964  -34.337    0.374   36.372  216.971 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 477.28860    2.43741  195.82   &lt;2e-16 ***
## Day           1.63822    0.06541   25.04   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 58.27 on 934 degrees of freedom
## Multiple R-squared:  0.4017, Adjusted R-squared:  0.4011 
## F-statistic: 627.2 on 1 and 934 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="applying-the-scientific-method.html#cb49-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(m.adg))</span></code></pre></div>
<p><img src="02-scientificmethod_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="applying-the-scientific-method.html#cb50-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m.adg))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(m.adg)
## W = 0.98986, p-value = 4.643e-06</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="applying-the-scientific-method.html#cb52-1" tabindex="-1"></a>d.bw2<span class="sc">$</span>pBW <span class="ot">=</span> <span class="fu">predict</span>(m.adg)</span>
<span id="cb52-2"><a href="applying-the-scientific-method.html#cb52-2" tabindex="-1"></a></span>
<span id="cb52-3"><a href="applying-the-scientific-method.html#cb52-3" tabindex="-1"></a>d.bw2 <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="applying-the-scientific-method.html#cb52-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day))<span class="sc">+</span></span>
<span id="cb52-5"><a href="applying-the-scientific-method.html#cb52-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pBW), <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>)<span class="sc">+</span></span>
<span id="cb52-6"><a href="applying-the-scientific-method.html#cb52-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> value), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="02-scientificmethod_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="applying-the-scientific-method.html#cb53-1" tabindex="-1"></a><span class="co"># ADG whole Period ----</span></span>
<span id="cb53-2"><a href="applying-the-scientific-method.html#cb53-2" tabindex="-1"></a>d.bw2 <span class="ot">=</span> <span class="fu">as.data.table</span>(d.bw2)</span>
<span id="cb53-3"><a href="applying-the-scientific-method.html#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="applying-the-scientific-method.html#cb53-4" tabindex="-1"></a>d.bw2[VID <span class="sc">==</span> <span class="st">&#39;249&#39;</span>, <span class="fu">list</span>(<span class="at">initialBW=</span><span class="fu">coef</span>(<span class="fu">lm</span>(value <span class="sc">~</span> Day))[<span class="dv">1</span>], </span>
<span id="cb53-5"><a href="applying-the-scientific-method.html#cb53-5" tabindex="-1"></a>                         <span class="at">ADG=</span><span class="fu">coef</span>(<span class="fu">lm</span>(value<span class="sc">~</span>Day))[<span class="dv">2</span>],</span>
<span id="cb53-6"><a href="applying-the-scientific-method.html#cb53-6" tabindex="-1"></a>                         <span class="at">NoWeights =</span> <span class="fu">length</span>(<span class="fu">unique</span>(Day)))]</span></code></pre></div>
<pre><code>##    initialBW      ADG NoWeights
##        &lt;num&gt;    &lt;num&gt;     &lt;int&gt;
## 1:  507.8051 1.796914        12</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="applying-the-scientific-method.html#cb55-1" tabindex="-1"></a>d.bw2<span class="fl">.249</span> <span class="ot">=</span> d.bw2[VID <span class="sc">==</span> <span class="st">&#39;249&#39;</span>,]</span>
<span id="cb55-2"><a href="applying-the-scientific-method.html#cb55-2" tabindex="-1"></a>m<span class="fl">.249</span> <span class="ot">=</span> <span class="fu">lm</span>(value <span class="sc">~</span> Day, <span class="at">data =</span> d.bw2<span class="fl">.249</span>)</span>
<span id="cb55-3"><a href="applying-the-scientific-method.html#cb55-3" tabindex="-1"></a><span class="fu">summary</span>(m<span class="fl">.249</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = value ~ Day, data = d.bw2.249)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -24.383  -8.986  -2.673   5.108  36.411 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 507.8051     7.1012  71.510 6.98e-15 ***
## Day           1.7969     0.1906   9.429 2.72e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.22 on 10 degrees of freedom
## Multiple R-squared:  0.8989, Adjusted R-squared:  0.8888 
## F-statistic:  88.9 on 1 and 10 DF,  p-value: 2.718e-06</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="applying-the-scientific-method.html#cb57-1" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(value<span class="sc">~</span>Day, <span class="at">data =</span> d.bw2<span class="fl">.249</span>))[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## (Intercept) 
##    507.8051</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="applying-the-scientific-method.html#cb59-1" tabindex="-1"></a>d.adg <span class="ot">=</span> d.bw2[,<span class="fu">list</span>(<span class="at">initialBW=</span><span class="fu">coef</span>(<span class="fu">lm</span>(value <span class="sc">~</span> Day))[<span class="dv">1</span>], </span>
<span id="cb59-2"><a href="applying-the-scientific-method.html#cb59-2" tabindex="-1"></a>                    <span class="at">ADG=</span><span class="fu">coef</span>(<span class="fu">lm</span>(value<span class="sc">~</span>Day))[<span class="dv">2</span>],</span>
<span id="cb59-3"><a href="applying-the-scientific-method.html#cb59-3" tabindex="-1"></a>                    <span class="at">NoWeights =</span> <span class="fu">length</span>(<span class="fu">unique</span>(Day))),</span>
<span id="cb59-4"><a href="applying-the-scientific-method.html#cb59-4" tabindex="-1"></a>              by<span class="ot">=</span>VID]</span></code></pre></div>
</div>
<div id="graphs" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Graphs<a href="applying-the-scientific-method.html#graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="applying-the-scientific-method.html#cb60-1" tabindex="-1"></a><span class="co"># Summary graphs ----</span></span>
<span id="cb60-2"><a href="applying-the-scientific-method.html#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="applying-the-scientific-method.html#cb60-3" tabindex="-1"></a>d.adg <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="applying-the-scientific-method.html#cb60-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ADG))<span class="sc">+</span></span>
<span id="cb60-5"><a href="applying-the-scientific-method.html#cb60-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb60-6"><a href="applying-the-scientific-method.html#cb60-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(d.adg<span class="sc">$</span>ADG)), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="02-scientificmethod_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="applying-the-scientific-method.html#cb62-1" tabindex="-1"></a>d.adg <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="applying-the-scientific-method.html#cb62-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ADG))<span class="sc">+</span></span>
<span id="cb62-3"><a href="applying-the-scientific-method.html#cb62-3" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="02-scientificmethod_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="applying-the-scientific-method.html#cb63-1" tabindex="-1"></a>d.bw2 <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="applying-the-scientific-method.html#cb63-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> value, <span class="at">color =</span> Creep))<span class="sc">+</span></span>
<span id="cb63-3"><a href="applying-the-scientific-method.html#cb63-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb63-4"><a href="applying-the-scientific-method.html#cb63-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="02-scientificmethod_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="science.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/02-scientificmethod.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["quantitative_thinking.pdf", "quantitative_thinking.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
